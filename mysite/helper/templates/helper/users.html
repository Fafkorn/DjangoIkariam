{% extends "base.html" %}
{% block head %}
        {% load static %}
        <link rel="stylesheet" type="text/css" href="{% static 'helper/users.css' %}">
        <script>
            $(function(){
                $('#order-select').change(function(){
                    $('#order-form').submit();
                });
            });
        </script>
        {% load helper_extras %}
{% endblock %}
{% block content %}
        {% load widget_tweaks %}

        {% include "helper/navigation.html" %}

        <div class="tile">
            <div class="row visited-users-div">
                {% for user in visited_users %}
                    <a class="btn btn-info btn-visit" href="{% url 'helper:user_towns' user.id %}">{{user.user_name}}</a>
                {% endfor %}
            </div>
        </div>

        <div class="page-div">
            <div>
                <form action="{% url 'helper:add_user' %}" method="post">
                    {% csrf_token %}
                    <input style="width: 200px; float: left" class="form-control"  type="text" name="user_name" placeholder="Nazwa użytkownika">
                    <button  class="btn btn-success btn-action" type="submit">Dodaj</button>
                </form>

            </div>
            <div>
                {% if buttons %}
                {% for button in buttons %}
                    <a href="{% url 'helper:users' %}?page={{button.1}}&username_search={{username_search}}&order_by={{order_by}}" class="btn btn-success  {% if button.1 == page_num %} disabled {% endif %}">{{button.0}}</a>
                {% endfor %}
                    <div style="display: inline-block">
                        <form action="{% url 'helper:users'%}" method="get" id="order-form" class="form-inline" >
                            {% csrf_token %}
                            <label style="margin-left: 15px; margin-right: 5px;">Sortuj według</label>
                            {% render_field my_filter.form.order_by class="form-control order-select" id="order-select"  %}
                            <button class="btn btn-success btn-action" type="submit" style="display: inline-block">Zastosuj</button>
                        </form>
                    </div>
                {% else %}
                <h5>Nie znaleziono graczy</h5>
                {% endif %}
            </div>

        </div>

        <div class="users-div">
            {% if users_list %}
                <table class="table">
                    <tr>
                        <th>#</th>
                        <th>Nazwa</th>
                        <th>Całkowity wynik</th>
                        <th>Mistrzowie budowy</th>
                        <th>Poziomy budynków</th>
                        <th>Naukowcy</th>
                        <th>Poziomy badań</th>
                        <th>Generałowie</th>
                        <th>Złoto</th>
                        <th>Punkty ofensywy</th>
                        <th>Punkty obrony</th>
                        <th>Handlarz</th>
                        <th>Surowce</th>
                        <th>Datki</th>
                        <th>Punkty Abordażu</th>
                    </tr>
                    {% for user in users_list %}
                        <tr>
                            <td>{{forloop.counter|get_pos:page_num }}</td>
                            <td><a class="player-a" href="{% url 'helper:user_towns' user.id %}">
                                {{ user.user_name }}
                                {% if user.alliance %}
                                    [{{user.alliance}}]
                                {% endif %}
                            </a></td>
                            <td>{{user.score|number_commas}}</td>
                            <td>{{user.master_builders|number_commas}}</td>
                            <td>{{user.building_levels|number_commas}}</td>
                            <td>{{user.scientists|number_commas}}</td>
                            <td>{{user.research_level|number_commas}}</td>
                            <td>{{user.generals|number_commas}}</td>
                            <td>{{user.gold|number_commas}}</td>
                            <td>{{user.offensive|number_commas}}</td>
                            <td>{{user.defensive|number_commas}}</td>
                            <td>{{user.trading|number_commas}}</td>
                            <td>{{user.resources|number_commas}}</td>
                            <td>{{user.donations|number_commas}}</td>
                            <td>{{user.piracy|number_commas}}</td>
                        </tr>
                    {% endfor %}
                </table>
            {% endif %}
        </div>
{% endblock %}